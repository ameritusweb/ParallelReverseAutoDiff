{
  "timeSteps": [
    {
      "startOperations": [
        {
          "id": "connected_paths_deepmatrix",
          "type": "MatrixConcatenateOperation",
          "inputs": [ "ConnectedPathsDeepMatrix" ],
          "gradientResultTo": [ "DConnectedPathsDeepMatrix" ]
        },
        {
          "id": "connected_paths_matrix_trans",
          "type": "MatrixTransposeOperation",
          "inputs": [ "connected_paths_deepmatrix" ]
        }
      ],
      "layers": [
        {
          "operations": [
            {
              "id": "weighted_currentPathFeatures",
              "type": "CudaMatrixMultiplyOperation",
              "inputs": [ "Weights", "CurrentPathFeatures" ],
              "gradientResultTo": [ "DWeights", null ],
              "initializations": [
                {
                  "type": "Xavier",
                  "rows": "numFeatures",
                  "columns": "numFeatures"
                },
                null
              ]
            },
            {
              "id": "currentPathFeatures_add",
              "type": "MatrixAddOperation",
              "inputs": [ "weighted_currentPathFeatures", "B" ],
              "gradientResultTo": [ null, "DB" ],
              "initializations": [
                null,
                {
                  "type": "Zeroes",
                  "rows": "numFeatures",
                  "columns": 1
                }
              ]
            },
            {
              "id": "weighted_connectedPathFeatures",
              "type": "CudaMatrixMultiplyOperation",
              "inputs": [ "connected_paths_matrix_trans_find", "ConnectedWeights" ],
              "gradientResultTo": [ null, "DConnectedWeights" ],
              "initializations": [
                null,
                {
                  "type": "Xavier",
                  "rows": "numFeatures",
                  "columns": "numFeatures"
                }
              ]
            },
            {
              "id": "connectedPathFeatures_add",
              "type": "MatrixAddBroadcastingOperation",
              "inputs": [ "weighted_connectedPathFeatures", "CB" ],
              "gradientResultTo": [ null, "DCB" ],
              "initializations": [
                null,
                {
                  "type": "Zeroes",
                  "rows": 1,
                  "columns": "numFeatures"
                }
              ]
            },
            {
              "id": "currentPathFeatures_add_trans",
              "type": "MatrixTransposeOperation",
              "inputs": [ "currentPathFeatures_add" ]
            },
            {
              "id": "connectedPathFeatures_add_trans",
              "type": "MatrixTransposeOperation",
              "inputs": [ "connectedPathFeatures_add" ]
            },
            {
              "id": "interactionScores",
              "type": "CudaMatrixMultiplyOperation",
              "inputs": [ "currentPathFeatures_add_trans", "connectedPathFeatures_add_trans" ]
            },
            {
              "id": "attention_scores",
              "type": "SoftmaxOperation",
              "inputs": [ "interactionScores" ]
            },
            {
              "id": "attention_scores_trans",
              "type": "MatrixTransposeOperation",
              "inputs": [ "attention_scores" ]
            },
            {
              "id": "broadcasted_attention_scores",
              "type": "MatrixBroadcastOperation",
              "inputs": [ "attention_scores_trans", "connectedPathsMatrixRows", "connectedPathsMatrixColumns" ]
            },
            {
              "id": "weighted_connected_paths_features",
              "type": "HadamardProductOperation",
              "inputs": [ "broadcasted_attention_scores", "connected_paths_matrix_trans_find" ],
            },
            {
              "id": "current_path_features_trans",
              "type": "MatrixTransposeOperation",
              "inputs": [ "weighted_connected_paths_features" ]
            },
            {
              "id": "current_path_features",
              "type": "MatrixSumOperation",
              "inputs": [ "current_path_features_trans" ],
              "setResultTo": "Output"
            }
          ]
        }
      ]
    }
  ]
}
