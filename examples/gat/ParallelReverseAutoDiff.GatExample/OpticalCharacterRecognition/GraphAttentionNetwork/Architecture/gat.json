{
  "timeSteps": [
    {
      "layers": [
        {
          "startOperations": [
            {
              "id": "node_features_transform",
              "type": "GpuMatrixMultiplyOperation",
              "inputs": [ "nodeFeatures", "linearWeights" ],
              "gradientResultTo": [ null, "DLinearWeights" ],
              "initializations": [
                null,
                {
                  "type": "Xavier",
                  "rows": "numFeatures",
                  "columns": "numFeaturesProjected"
                }
              ]
            },
            {
              "id": "transformed_features_add",
              "type": "MatrixAddBroadcastingOperation",
              "inputs": [ "node_features_transform", "transformationBias" ],
              "gradientResultTo": [ null, "DTransformationBias" ],
              "initializations": [
                null,
                {
                  "type": "Xavier",
                  "rows": "1",
                  "columns": "numFeaturesProjected"
                }
              ]
            },
            {
              "id": "rms_norm_transformed",
              "type": "RMSNormOperation",
              "inputs": [ "transformed_features_add", "G" ],
              "gradientResultTo": [ null, "DG" ]
            },
            {
              "id": "transformed_act",
              "type": "LeakyReLUOperation",
              "inputs": [ "rms_norm_transformed" ]
            },
            {
              "id": "features_keys",
              "type": "GpuMatrixMultiplyOperation",
              "inputs": [ "transformed_act", "Keys" ],
              "gradientResultTo": [ null, "DKeys" ],
              "initializations": [
                null,
                {
                  "type": "Xavier",
                  "rows": "numFeaturesProjected",
                  "columns": "numFeaturesProjected"
                }
              ]
            },
            {
              "id": "features_values",
              "type": "GpuMatrixMultiplyOperation",
              "inputs": [ "transformed_act", "Values" ],
              "gradientResultTo": [ null, "DValues" ],
              "initializations": [
                null,
                {
                  "type": "Xavier",
                  "rows": "numFeaturesProjected",
                  "columns": "numFeaturesProjected"
                }
              ]
            },
            {
              "id": "features_keys_transpose",
              "type": "MatrixTransposeOperation",
              "inputs": [ "features_keys_transpose" ]
            },
            {
              "id": "multi_query_self_attention",
              "type": "MultiQuerySelfAttentionOperation",
              "inputs": [ "transformed_act", "MultipleQueries", "features_keys_transpose" ],
              "gradientResultTo": [ null, "DMultipleQueries", null ]
            },
            {
              "id": "attention_scale",
              "type": "MatrixMultiplyScalarOperation",
              "inputs": [ "multi_query_self_attention", "Divisor" ]
            },
            {
              "id": "attention_weights",
              "type": "SineSoftmaxOperation",
              "inputs": [ "attention_scale" ]
            },
            {
              "id": "attention_weights_values",
              "type": "HadamardProductOperation",
              "inputs": [ "attention_weights", "features_values" ]
            }
          ],
          "layers": [
            {
              "operations": [
                {
                  "id": "graph_attention",
                  "type": "GraphAttentionOperation",
                  "inputs": [ "attention_weights_values", "AdjacencyMatrix", "AttentionWeights" ],
                  "gradientResultTo": [ null, "DAttentionWeights" ]
                },
                {
                  "id": "attention_leaky_relu",
                  "type": "LeakyReLUOperation",
                  "inputs": [ "graph_attention" ]
                },
                {
                  "id": "normalize_attention",
                  "type": "SoftmaxOperation",
                  "inputs": [ "attention_leaky_relu" ]
                },
                {
                  "id": "feature_aggregation",
                  "type": "FeatureAggregationOperation",
                  "inputs": [ "normalize_attention", "transformed_act" ]
                }
              ]
            }
          ],
          "endOperations": [
            {
              "id": "deep_concatenate",
              "type": "DeepConcatenateOperation",
              "inputs": [ "feature_aggregation_output" ]
            },
            {
              "id": "deep_pairwise_attention",
              "type": "DeepPairwiseAttentionOperation",
              "inputs": [ "deep_concatenate" ]
            },
            {
              "id": "deep_elementwise_multiply_sum",
              "type": "DeepMatrixElementWiseMultiplySumOperation",
              "inputs": [ "deep_concatenate", "deep_pairwise_attention" ]
            },
            {
              "id": "rmsnorm",
              "type": "RMSNormOperation",
              "inputs": [ "deep_elemenwise_multiply_sum" ]
            },
            {
              "id": "end_layer_act",
              "type": "LeakyReLUOperation",
              "inputs": [ "rmsnorm" ]
            }
          ]
        }
      ],
      "endoperations": [
        {
          "id": "output",
          "type": "MatrixRowConcatenateOperation",
          "inputs": [ "end_layer_act_last" ]
        }
      ]
    }
  ]
}