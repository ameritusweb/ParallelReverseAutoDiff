{
  "timeSteps": [
    {
      "layers": [
        {
          "startOperations": [
            {
              "id": "node_features_transform",
              "type": "GpuMatrixMultiplyOperation",
              "inputs": [ "nodeFeatures", "LinearWeights" ],
              "gradientResultTo": [ null, "DLinearWeights" ],
              "initializations": [
                null,
                {
                  "type": "Xavier",
                  "rows": "numFeatures",
                  "columns": "numFeaturesProjected"
                }
              ]
            },
            {
              "id": "transformed_features_add",
              "type": "MatrixAddBroadcastingOperation",
              "inputs": [ "node_features_transform", "TransformationBias" ],
              "gradientResultTo": [ null, "DTransformationBias" ],
              "initializations": [
                null,
                {
                  "type": "Xavier",
                  "rows": "1",
                  "columns": "numFeaturesProjected"
                }
              ]
            },
            {
              "id": "rms_norm_transformed",
              "type": "RMSNormOperation",
              "inputs": [ "transformed_features_add", "G" ],
              "gradientResultTo": [ null, "DG" ],
              "initializations": [
                null,
                {
                  "type": "Xavier",
                  "rows": "numFeatures",
                  "columns": "numFeaturesProjected"
                }
              ]
            },
            {
              "id": "transformed_act",
              "type": "LeakyReLUOperation",
              "inputs": [ "rms_norm_transformed" ]
            },
            {
              "id": "features_keys",
              "type": "GpuMatrixMultiplyOperation",
              "inputs": [ "transformed_act", "Keys" ],
              "gradientResultTo": [ null, "DKeys" ],
              "initializations": [
                null,
                {
                  "type": "Xavier",
                  "rows": "numFeaturesProjected",
                  "columns": "numFeaturesProjected"
                }
              ]
            },
            {
              "id": "features_values",
              "type": "GpuMatrixMultiplyOperation",
              "inputs": [ "transformed_act", "Values" ],
              "gradientResultTo": [ null, "DValues" ],
              "initializations": [
                null,
                {
                  "type": "Xavier",
                  "rows": "numFeaturesProjected",
                  "columns": "numFeaturesProjected"
                }
              ]
            },
            {
              "id": "features_keys_transpose",
              "type": "MatrixTransposeOperation",
              "inputs": [ "features_keys" ]
            },
            {
              "id": "queries_keys",
              "type": "GpuMatrixMultiplyOperation",
              "inputs": [ "Queries", "features_keys_transpose" ],
              "gradientResultTo": [ "DQueries", null ],
              "initializations": [
                {
                  "type": "Xavier",
                  "rows": "numFeaturesProjected",
                  "columns": "numFeaturesProjected"
                },
                null
              ]
            },
            {
              "id": "queries_keys_transpose",
              "type": "MatrixTransposeOperation",
              "inputs": [ "queries_keys" ]
            },
            {
              "id": "attention_scale",
              "type": "MatrixMultiplyScalarOperation",
              "inputs": [ "queries_keys_transpose", "Divisor" ]
            },
            {
              "id": "attention_weights",
              "type": "SineSoftmaxOperation",
              "inputs": [ "attention_scale" ]
            },
            {
              "id": "attention_weights_values",
              "type": "HadamardProductOperation",
              "inputs": [ "attention_weights", "features_values" ]
            }
          ],
          "layers": [
            {
              "operations": [
                {
                  "id": "graph_adjacency",
                  "type": "SigmoidOperation",
                  "inputs": [ "AdjacencyMatrix" ]
                },
                {
                  "id": "graph_attention",
                  "type": "GraphAttentionOperation",
                  "inputs": [ "attention_weights_values", "graph_adjacency", "AttentionWeights" ],
                  "gradientResultTo": [ null, null, "DAttentionWeights" ]
                },
                {
                  "id": "attention_leaky_relu",
                  "type": "LeakyReLUOperation",
                  "inputs": [ "graph_attention" ]
                },
                {
                  "id": "normalize_attention",
                  "type": "SineSoftmaxOperation",
                  "inputs": [ "attention_leaky_relu" ]
                },
                {
                  "id": "feature_aggregation",
                  "type": "FeatureAggregationOperation",
                  "inputs": [ "normalize_attention", "transformed_act" ]
                }
              ]
            }
          ],
          "endOperations": [
            {
              "id": "deep_concatenate",
              "type": "DeepConcatenateOperation",
              "inputs": [ "feature_aggregation_array" ]
            },
            {
              "id": "deep_pairwise_attention",
              "type": "DeepPairwiseAttentionOperation",
              "inputs": [ "deep_concatenate", "PairwiseAttentionWeights" ]
            },
            {
              "id": "deep_elementwise_multiply_sum",
              "type": "DeepMatrixElementWiseMultiplySumOperation",
              "inputs": [ "deep_concatenate", "deep_pairwise_attention" ]
            },
            {
              "id": "fully_connected",
              "type": "GpuMatrixMultiplyOperation",
              "inputs": [ "deep_elementwise_multiply_sum", "FW" ],
              "gradientResultTo": [ null, "DFW" ]
            },
            {
              "id": "fully_connected_add",
              "type": "MatrixAddBroadcastingOperation",
              "inputs": [ "fully_connected", "FB" ],
              "gradientResultTo": [ null, "DFB" ]
            },
            {
              "id": "fully_connected_2",
              "type": "GpuMatrixMultiplyOperation",
              "inputs": [ "deep_elementwise_multiply_sum", "F2W" ],
              "gradientResultTo": [ null, "DF2W" ]
            },
            {
              "id": "fully_connected_2_add",
              "type": "MatrixAddBroadcastingOperation",
              "inputs": [ "fully_connected_2", "F2B" ],
              "gradientResultTo": [ null, "DF2B" ]
            },
            {
              "id": "fully_connected_act",
              "type": "SwishOperation",
              "inputs": [ "fully_connected_add", "Beta" ],
              "gradientResultTo": [ null, "DBeta" ]
            },
            {
              "id": "swiglu_act",
              "type": "HadamardProductOperation",
              "inputs": [ "fully_connected_act", "fully_connected_2_add" ]
            }
          ]
        }
      ],
      "endoperations": [
        {
          "id": "pre_output",
          "type": "MatrixRowConcatenateOperation",
          "inputs": [ "swiglu_act_last" ],
        },
        {
          "id": "output",
          "type": "VariedSoftmaxOperation",
          "inputs": [ "pre_output" ],
          "setResultTo": "Output"
        }
      ]
    }
  ]
}